21/06/23 15:48:44 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
21/06/23 15:48:46 INFO RMProxy: Connecting to ResourceManager at ip-192-168-47-162.cn-northwest-1.compute.internal/192.168.47.162:8032
21/06/23 15:48:47 INFO Client: Requesting a new application from cluster with 3 NodeManagers
21/06/23 15:48:47 INFO Configuration: resource-types.xml not found
21/06/23 15:48:47 INFO ResourceUtils: Unable to find 'resource-types.xml'.
21/06/23 15:48:47 INFO Client: Verifying our application has not requested more than the maximum memory capability of the cluster (24576 MB per container)
21/06/23 15:48:47 INFO Client: Will allocate AM container, with 1408 MB memory including 384 MB overhead
21/06/23 15:48:47 INFO Client: Setting up container launch context for our AM
21/06/23 15:48:47 INFO Client: Setting up the launch environment for our AM container
21/06/23 15:48:47 INFO Client: Preparing resources for our AM container
21/06/23 15:48:47 WARN Client: Neither spark.yarn.jars nor spark.yarn.archive is set, falling back to uploading libraries under SPARK_HOME.
21/06/23 15:48:49 INFO Client: Uploading resource file:/mnt/tmp/spark-a967a9e9-2808-440a-8ae6-9bc02bc29342/__spark_libs__3417514724514776695.zip -> hdfs://ip-192-168-47-162.cn-northwest-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1624409995971_0153/__spark_libs__3417514724514776695.zip
21/06/23 15:48:50 INFO Client: Uploading resource file:/etc/spark/conf/hive-site.xml -> hdfs://ip-192-168-47-162.cn-northwest-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1624409995971_0153/hive-site.xml
21/06/23 15:48:50 INFO Client: Uploading resource s3://ph-platform/2020-11-11/jobs/python/phcli/Auto_Max_liyx/Max_check/phmain.py -> hdfs://ip-192-168-47-162.cn-northwest-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1624409995971_0153/phmain.py
21/06/23 15:48:50 INFO S3NativeFileSystem: Opening 's3://ph-platform/2020-11-11/jobs/python/phcli/Auto_Max_liyx/Max_check/phmain.py' for reading
21/06/23 15:48:50 INFO Client: Uploading resource file:/usr/lib/spark/python/lib/pyspark.zip -> hdfs://ip-192-168-47-162.cn-northwest-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1624409995971_0153/pyspark.zip
21/06/23 15:48:50 INFO Client: Uploading resource file:/usr/lib/spark/python/lib/py4j-0.10.9-src.zip -> hdfs://ip-192-168-47-162.cn-northwest-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1624409995971_0153/py4j-0.10.9-src.zip
21/06/23 15:48:50 INFO Client: Uploading resource s3://ph-platform/2020-11-11/jobs/python/phcli/common/phcli-3.0.26-py3.8.egg -> hdfs://ip-192-168-47-162.cn-northwest-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1624409995971_0153/phcli-3.0.26-py3.8.egg
21/06/23 15:48:50 INFO S3NativeFileSystem: Opening 's3://ph-platform/2020-11-11/jobs/python/phcli/common/phcli-3.0.26-py3.8.egg' for reading
21/06/23 15:48:51 INFO Client: Uploading resource s3://ph-platform/2020-11-11/jobs/python/phcli/Auto_Max_liyx/Max_check/phjob.py -> hdfs://ip-192-168-47-162.cn-northwest-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1624409995971_0153/phjob.py
21/06/23 15:48:51 INFO S3NativeFileSystem: Opening 's3://ph-platform/2020-11-11/jobs/python/phcli/Auto_Max_liyx/Max_check/phjob.py' for reading
21/06/23 15:48:51 INFO Client: Uploading resource file:/mnt/tmp/spark-a967a9e9-2808-440a-8ae6-9bc02bc29342/__spark_conf__5116337664726054052.zip -> hdfs://ip-192-168-47-162.cn-northwest-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1624409995971_0153/__spark_conf__.zip
21/06/23 15:48:51 INFO SecurityManager: Changing view acls to: hadoop
21/06/23 15:48:51 INFO SecurityManager: Changing modify acls to: hadoop
21/06/23 15:48:51 INFO SecurityManager: Changing view acls groups to: 
21/06/23 15:48:51 INFO SecurityManager: Changing modify acls groups to: 
21/06/23 15:48:51 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(hadoop); groups with view permissions: Set(); users  with modify permissions: Set(hadoop); groups with modify permissions: Set()
21/06/23 15:48:51 INFO Client: Submitting application application_1624409995971_0153 to ResourceManager
21/06/23 15:48:51 INFO YarnClientImpl: Submitted application application_1624409995971_0153
21/06/23 15:48:52 INFO Client: Application report for application_1624409995971_0153 (state: ACCEPTED)
21/06/23 15:48:52 INFO Client: 
	 client token: N/A
	 diagnostics: AM container is launched, waiting for AM container to Register with RM
	 ApplicationMaster host: N/A
	 ApplicationMaster RPC port: -1
	 queue: default
	 start time: 1624434531329
	 final status: UNDEFINED
	 tracking URL: http://ip-192-168-47-162.cn-northwest-1.compute.internal:20888/proxy/application_1624409995971_0153/
	 user: hadoop
21/06/23 15:48:53 INFO Client: Application report for application_1624409995971_0153 (state: ACCEPTED)
21/06/23 15:48:54 INFO Client: Application report for application_1624409995971_0153 (state: ACCEPTED)
21/06/23 15:48:55 INFO Client: Application report for application_1624409995971_0153 (state: ACCEPTED)
21/06/23 15:48:56 INFO Client: Application report for application_1624409995971_0153 (state: ACCEPTED)
21/06/23 15:48:57 INFO Client: Application report for application_1624409995971_0153 (state: ACCEPTED)
21/06/23 15:48:58 INFO Client: Application report for application_1624409995971_0153 (state: ACCEPTED)
21/06/23 15:48:59 INFO Client: Application report for application_1624409995971_0153 (state: ACCEPTED)
21/06/23 15:49:00 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:00 INFO Client: 
	 client token: N/A
	 diagnostics: N/A
	 ApplicationMaster host: ip-192-168-9-56.cn-northwest-1.compute.internal
	 ApplicationMaster RPC port: 42947
	 queue: default
	 start time: 1624434531329
	 final status: UNDEFINED
	 tracking URL: http://ip-192-168-47-162.cn-northwest-1.compute.internal:20888/proxy/application_1624409995971_0153/
	 user: hadoop
21/06/23 15:49:01 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:02 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:03 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:04 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:05 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:06 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:07 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:08 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:09 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:10 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:11 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:12 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:13 INFO Client: Application report for application_1624409995971_0153 (state: ACCEPTED)
21/06/23 15:49:13 INFO Client: 
	 client token: N/A
	 diagnostics: AM container is launched, waiting for AM container to Register with RM
	 ApplicationMaster host: N/A
	 ApplicationMaster RPC port: -1
	 queue: default
	 start time: 1624434531329
	 final status: UNDEFINED
	 tracking URL: http://ip-192-168-47-162.cn-northwest-1.compute.internal:20888/proxy/application_1624409995971_0153/
	 user: hadoop
21/06/23 15:49:14 INFO Client: Application report for application_1624409995971_0153 (state: ACCEPTED)
21/06/23 15:49:15 INFO Client: Application report for application_1624409995971_0153 (state: ACCEPTED)
21/06/23 15:49:16 INFO Client: Application report for application_1624409995971_0153 (state: ACCEPTED)
21/06/23 15:49:17 INFO Client: Application report for application_1624409995971_0153 (state: ACCEPTED)
21/06/23 15:49:18 INFO Client: Application report for application_1624409995971_0153 (state: ACCEPTED)
21/06/23 15:49:19 INFO Client: Application report for application_1624409995971_0153 (state: ACCEPTED)
21/06/23 15:49:20 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:20 INFO Client: 
	 client token: N/A
	 diagnostics: N/A
	 ApplicationMaster host: ip-192-168-11-224.cn-northwest-1.compute.internal
	 ApplicationMaster RPC port: 38905
	 queue: default
	 start time: 1624434531329
	 final status: UNDEFINED
	 tracking URL: http://ip-192-168-47-162.cn-northwest-1.compute.internal:20888/proxy/application_1624409995971_0153/
	 user: hadoop
21/06/23 15:49:21 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:22 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:23 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:24 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:25 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:26 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:27 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:28 INFO Client: Application report for application_1624409995971_0153 (state: RUNNING)
21/06/23 15:49:29 INFO Client: Application report for application_1624409995971_0153 (state: FINISHED)
21/06/23 15:49:29 INFO Client: 
	 client token: N/A
	 diagnostics: User application exited with status 1
	 ApplicationMaster host: ip-192-168-11-224.cn-northwest-1.compute.internal
	 ApplicationMaster RPC port: 38905
	 queue: default
	 start time: 1624434531329
	 final status: FAILED
	 tracking URL: http://ip-192-168-47-162.cn-northwest-1.compute.internal:20888/proxy/application_1624409995971_0153/
	 user: hadoop
21/06/23 15:49:29 INFO Client: Deleted staging directory hdfs://ip-192-168-47-162.cn-northwest-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1624409995971_0153
21/06/23 15:49:29 ERROR Client: Application diagnostics message: User application exited with status 1
Exception in thread "main" org.apache.spark.SparkException: Application application_1624409995971_0153 finished with failed status
	at org.apache.spark.deploy.yarn.Client.run(Client.scala:1196)
	at org.apache.spark.deploy.yarn.YarnClusterApplication.start(Client.scala:1587)
	at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:936)
	at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)
	at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)
	at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)
	at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1015)
	at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1024)
	at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/06/23 15:49:29 INFO ShutdownHookManager: Shutdown hook called
21/06/23 15:49:29 INFO ShutdownHookManager: Deleting directory /mnt/tmp/spark-a967a9e9-2808-440a-8ae6-9bc02bc29342
21/06/23 15:49:29 INFO ShutdownHookManager: Deleting directory /mnt/tmp/spark-87d5d2d8-b736-41aa-8145-e0a138d323db
Command exiting with ret '1'
